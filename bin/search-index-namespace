#!/usr/bin/env python
import time

import click

from inbox.search.util import index_namespace


@click.command()
@click.option('--namespace_public_id', default=None)
@click.option('--updated_since', default=None)
def create_namespace_index(namespace_public_id, updated_since):
    """
    Create an Elasticsearch index for a namespace and index its threads and
    messages. All namespaces are indexed by default, use `namespace_public_id`
    to specify only one.

    """
    start_time = time.time()

    indexed_count = index_namespace(namespace_public_id, updated_since)

    elapsed_time = time.time() - start_time
    print 'indexed {} objects in {} seconds'.format(indexed_count,
                                                    elapsed_time)


if __name__ == '__main__':
    create_namespace_index()
